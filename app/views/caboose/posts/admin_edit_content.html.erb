<%
# app/views/caboose/posts/admin_edit_content.html.erb
%>

<% content_for :caboose_css do %>
<%= stylesheet_link_tag 'jquery-ui' %>
<%= stylesheet_link_tag 'caboose/admin_block_edit_image' %>
<%= stylesheet_link_tag 'caboose/admin_post_edit_content' %>
<%= stylesheet_link_tag "caboose/modal_inline" %>
<style type='text/css'>

#tiny_header {
  display: block;  
  color: #fff;
  background-image: url(/assets/caboose/caboose_logo_small.png);
  background-color: #000;  
  background-repeat: no-repeat;
  background-position: right 0;
  padding: 0 50px 0 10px;
  position: absolute;
  top: 0px;
  right: 0px;
  z-index: 100000;
  border-left: #fff 1px solid;
  border-bottom: #fff 1px solid;  
}
#tiny_header a {
  display: inline-block;
  color: #fff;
  padding: 16px 10px;  
}
.block_over { background: #e3e3e3; }
.select_handle    { display: none; }
.move_up_handle   { display: none; }
.move_down_handle { display: none; }
.delete_handle    { display: none; }
.duplicate_handle    { display: none; }
.block_over > .select_handle    { display: block; position: relative; }
.block_over > .move_up_handle   { display: block; position: relative; }
.block_over > .move_down_handle { display: block; position: relative; }
.block_over > .delete_handle    { display: block; position: relative; }
.block_over > .duplicate_handle    { display: block; position: relative; }
.block_over > .select_handle    span { position: absolute; top: 0; right: 72px; width: 18px; height: 18px; background-color: #fff; border: #ccc 1px solid; }
.block_over > .move_up_handle   span { position: absolute; top: 0; right: 36px; width: 18px; height: 18px; background-color: #fff; border: #ccc 1px solid; }
.block_over > .move_down_handle span { position: absolute; top: 0; right: 18px; width: 18px; height: 18px; background-color: #fff; border: #ccc 1px solid; }
.block_over > .delete_handle    span { position: absolute; top: 0; right:  0px; width: 18px; height: 18px; background-color: #fff; border: #ccc 1px solid; }
.block_over > .duplicate_handle    span { position: absolute; top: 0; right:  54px; width: 18px; height: 18px; background-color: #fff; border: #ccc 1px solid; }

.selected { background: #fff799; }

.new_block_link { position: relative; width: 100%; }
.new_block_link .line { position: absolute; top: -11px; width: 100%; height: 2px; background: transparent; }
.new_block_link a { position: absolute; top: -20px; left: 45%; background: transparent; color: transparent !important; display: block; padding: 4px 8px; }

.new_block_link_over { position: relative; width: 100%; }
.new_block_link_over .line { position: absolute; top: -11px; width: 100%; height: 2px; background: #ccc; }
.new_block_link_over a { position: absolute; top: -22px; left: 45%; color: #fff; background: #666; display: block; padding: 2px 4px; text-decoration: none; font-size: 12px; }

.caboose_note { padding: 10px 20px; background: #990000; color: #fff; font-size: 16px; }

</style>
<% end %>

<% content_for :caboose_js do %>
<%= javascript_include_tag 'jquery-ui' %>
<%= javascript_include_tag 'caboose/model/all' %>
<%= javascript_include_tag 'caboose/jquery-ui.drag-multiple.min.js' %>
<%= javascript_include_tag "caboose/clipboard" %>
<%= javascript_include_tag 'caboose/block_content_controller' %>
<%= javascript_include_tag "caboose/class" %>
<%= javascript_include_tag "caboose/modal_controller" %>
<%= javascript_include_tag "caboose/block_modal_controllers/block_modal_controller" %>
<script type='text/javascript'>

var controller = false;
$(document).ready(function() {  
  controller = new BlockContentController({
    post_id: <%= @post.id %>,
    assets_path: <%= raw Caboose.json(asset_path('loading.gif').gsub('loading.gif', '')) %>,
    included_assets: ['caboose/block_modal_controllers/block_modal_controller.js']
  });

  $('body').append($('<div/>')        
    .attr('id', 'tiny_header')
    .append($('<a/>').attr('href', '/admin/posts').html("< Back"))
    .append($('<a/>').attr('href', '#').html('Post Options').click(function(e) { e.preventDefault(); caboose_modal_url('/admin/posts/<%= @post.id %>/custom-fields'); }))
    .append($('<a/>').attr('href', '/admin/posts/<%= @post.id %>/layout').html("Layout"))
    .append($('<a/>').attr('href', '/admin/posts/<%= @post.id %>').html("Settings"))        
  );    
});

</script>
<% end %>

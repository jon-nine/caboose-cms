<%
p = @product
%>
<%= render :partial => 'caboose/products/admin_header' %>

<div id='product_<%= p.id %>_category_id'></div>

<%= render :partial => 'caboose/products/admin_footer' %>

<% content_for :caboose_css do %>
<style type='text/css'>
#categories input[type='checkbox'] { position: relative; }
#categories ul { list-style: none; margin: 0; padding: 0; }
#categories ul ul ul { margin-left: 20px; }
#categories li { list-style: none; }
#categories h3 { margin: 0; padding: 0; font-weight: bold; display: inline; }
#categories td { padding: 10px; }
</style>
<% end %>
<% content_for :caboose_js do %>
<script type='text/javascript'>

var mb = false;
$(document).ready(function() {
  mb = new ModelBinder({
    name: 'Product',
    id: <%= p.id %>,
    update_url: '/admin/products/<%= p.id %>',
    authenticity_token: '<%= form_authenticity_token %>',
    attributes: [
      {
        name: 'category_id',
        nice_name: 'Categories',
        type: 'checkbox-multiple',        
        options_url: '/admin/categories/options',
        value: <%= raw Caboose.json(p.categories.collect{ |cat| cat.id }) %>,
        fixed_placeholder: false,
        width: 400
      }      
    ]
  });  
});

</script>
<% end %>

<div id="checkout" class='constrain'> 
  <section id="checkout-shipping">  
    <div class="wrapper">
      <% if @rates.count > 1 %>
        <p>Your package must be shipped in multiple packages.  Please select 
        how you would like each package to be delivered.</p>
      <% end %>
      <table>
        <tr>
          <th>Package</th>
          <th>Shipping Options</th>
        </tr>        
        <% @rates.each_with_index do |arr, i| %>
          <% op = arr[0] %>
          <% sp = op.shipping_package %>          
          <tr>                    
            <td valign='top'>
              <ul><% op.line_items.each do |li| %><li><%= li.variant.product.title %> (<%= li.variant.title %>)<% end %></ul>
            </td>
            <td valign='top'>
              <% arr[1].each do |rate| %>          
                <button class="blue" data-shipping-code="<%= rate[:service_code] %>" data-shipping-method="<%= rate[:service_name] %>">
                  <%= number_to_currency(rate[:total_price], :precision => 2) %><br /><%= rate[:service_name] %>
                </button>
              <% end %>
            </td>
          </tr>        
        <% end %>
      </table>
    </div>    
  </section>  
  <section id="checkout-continue">
    <div id='message'></div>        
    <a href="/">return to the store</a>
  </section>
</div>
                                    
<%= content_for :caboose_js do %>
<%= javascript_include_tag 'caboose/checkout_step3' %>
<% end %>
<%= content_for :caboose_css do %>
<%= stylesheet_link_tag 'caboose/message_boxes' %>
<%= stylesheet_link_tag 'caboose/checkout' %>
<% end %>